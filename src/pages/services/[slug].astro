---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { siteConfig } from '../../site.config';
import { forensicServices } from '../../data/forensicServices';
import { forensicServicePages } from '../../data/forensicServicePages';

export function getStaticPaths() {
  return forensicServices.map((s) => ({ params: { slug: s.slug } }));
}

const { slug } = Astro.params;
const service = forensicServices.find((s) => s.slug === slug);
const content = forensicServicePages[slug!];

if (!service || !content) {
  return Astro.redirect('/');
}

const metaTitle = content.metaTitle;
const metaDescription = content.metaDescription;

const serviceSchema = {
  '@context': 'https://schema.org',
  '@type': 'Service',
  name: content.title,
  description: content.metaDescription,
  provider: { '@type': 'LocalBusiness', name: siteConfig.name },
  areaServed: siteConfig.areas.map((a) => ({ '@type': 'City', name: a })),
};
---
<BaseLayout title={metaTitle} description={metaDescription}>
  <script type="application/ld+json" set:html={JSON.stringify(serviceSchema)} />

  <article class="mx-auto max-w-4xl px-4 py-12 sm:px-6">
    <header>
      <a href="/#services-heading" class="text-sm text-navy-muted hover:text-navy">‚Üê All services</a>
      <h1 class="mt-4 font-serif text-3xl font-bold tracking-tight text-navy sm:text-4xl">
        {content.title}
      </h1>
    </header>

    <section class="mt-10" aria-labelledby="problem-heading">
      <h2 id="problem-heading" class="text-xl font-semibold text-navy">Problem</h2>
      <p class="mt-2 text-navy-muted leading-relaxed">{content.problem}</p>
    </section>

    <section class="mt-10" aria-labelledby="risk-heading">
      <h2 id="risk-heading" class="text-xl font-semibold text-navy">Risk</h2>
      <p class="mt-2 text-navy-muted leading-relaxed">{content.risk}</p>
    </section>

    <section class="mt-10" aria-labelledby="investigation-heading">
      <h2 id="investigation-heading" class="text-xl font-semibold text-navy">Investigation</h2>
      <p class="mt-2 text-navy-muted leading-relaxed">{content.investigation}</p>
    </section>

    <section class="mt-10" aria-labelledby="findings-heading">
      <h2 id="findings-heading" class="text-xl font-semibold text-navy">Findings</h2>
      <p class="mt-2 text-navy-muted leading-relaxed">{content.findings}</p>
    </section>

    <section class="mt-10" aria-labelledby="report-heading">
      <h2 id="report-heading" class="text-xl font-semibold text-navy">Report output</h2>
      <ul class="mt-2 list-disc list-inside space-y-1 text-navy-muted">
        {content.reportOutput.map((item) => (
          <li>{item}</li>
        ))}
      </ul>
    </section>

    <section class="mt-10 rounded-lg border border-gray-200 bg-gray-50 p-6">
      <h2 class="text-lg font-semibold text-navy">Where we work</h2>
      <p class="mt-2 text-sm text-navy-muted">Southampton, Winchester, London, Hampshire & South East.</p>
      <ul class="mt-3 flex flex-wrap gap-2">
        <li><a href="/southampton" class="text-primary hover:underline">Southampton</a></li>
        <li><a href="/winchester" class="text-primary hover:underline">Winchester</a></li>
        <li><a href="/london" class="text-primary hover:underline">London</a></li>
      </ul>
    </section>

    <section class="mt-10 flex flex-wrap gap-4">
      <a href="/contact" class="rounded bg-navy px-6 py-3 font-semibold text-white no-underline hover:bg-navy-light">Commission investigation</a>
      <a href="/contact" class="rounded border-2 border-navy px-6 py-3 font-semibold text-navy no-underline hover:bg-navy hover:text-white">Request case review</a>
    </section>
  </article>
</BaseLayout>
